% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SM_CreateSequenceMap.R
\name{createSequenceMap}
\alias{createSequenceMap}
\title{Create Sequence Map}
\usage{
createSequenceMap(
  SEMATS,
  sequence,
  genome = NULL,
  moving_average = 40,
  WidthIntoExon = 50,
  WidthIntoIntron = 250,
  return_data = FALSE
)
}
\arguments{
\item{SEMATS}{A data frame containing SE.MATS output with columns:
chr, strand, upstreamES, upstreamEE, exonStart_0base, exonEnd,
downstreamES, downstreamEE, GeneID}

\item{sequence}{Character string of the target sequence motif to search for
(e.g., "CCCC", "YGCY"). Supports IUPAC ambiguity codes.}

\item{genome}{A BSgenome object. Default uses BSgenome.Hsapiens.UCSC.hg38.}

\item{moving_average}{Integer specifying the window size for moving average
smoothing. Set to NULL or 0 to disable smoothing. Default is 40.}

\item{WidthIntoExon}{Integer specifying how many bp to extend into exons.
Default is 50.}

\item{WidthIntoIntron}{Integer specifying how many bp to extend into introns.
Default is 250.}

\item{return_data}{Logical. If TRUE, returns the frequency data frame instead
of a plot. Default is FALSE.}
}
\value{
A ggplot object showing sequence frequency across the 4 regions,
or a data frame if return_data = TRUE.
}
\description{
Analyzes the frequency of a target sequence motif across splicing junction
regions. Uses the same 4-region structure as createSplicingMap to show
where specific sequences appear relative to exon/intron boundaries.
}
\details{
The function divides each splicing event into 4 regions of (WidthIntoExon +
WidthIntoIntron) bp each:
\itemize{
\item Region 1: Upstream exon end to first intron
\item Region 2: First intron end to middle (skipped) exon start
\item Region 3: Middle exon end to second intron
\item Region 4: Second intron end to downstream exon start
}

At each position, the function checks if the target sequence starts there.
The frequency is calculated as: (events with motif at position) / (total events)
}
\examples{
\dontrun{
library(BSgenome.Hsapiens.UCSC.hg38)

# Basic usage
createSequenceMap(SEMATS = my_semats_data, sequence = "CCCC")

# Search for YCAY motif (Y = C or T)
createSequenceMap(SEMATS = my_semats_data, sequence = "YCAY")

# Return data instead of plot
freq_data <- createSequenceMap(SEMATS = my_semats_data,
                                sequence = "GGGG",
                                return_data = TRUE)
}

}
