% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RG_PlotRegion.R
\name{PlotRegion}
\alias{PlotRegion}
\title{Plot RNA-Binding Protein Peaks on a Genomic Region}
\usage{
PlotRegion(
  Chr = NULL,
  Start = NULL,
  End = NULL,
  Strand = NULL,
  geneID = NULL,
  gtf = NULL,
  bed = NULL,
  species = "Human",
  TxID = NA,
  Target_col = NULL,
  omit = c(),
  order_by = "Count",
  order_in = NULL,
  merge = 0,
  peaks_width = 0.3,
  utr_col = "dark gray",
  peak_col = "Blue",
  exon_width = 0.5,
  utr_width = 0.3,
  exon_col = "black",
  RNA_Peaks_File_Path = "~/Desktop/RNAPeaks.pdf",
  Bed_File_Path = "~/Desktop/BEDFILE_PEAKS.csv",
  ...
)
}
\arguments{
\item{Chr}{Chromosome name (e.g., "1", "X", "chr1").}

\item{Start}{Start position of the genomic region (bp).}

\item{End}{End position of the genomic region (bp).}

\item{Strand}{Strand to display ("+" or "-").}

\item{geneID}{Optional gene identifier to focus on a specific gene.}

\item{gtf}{Optional pre-loaded GTF annotation data frame. If NULL, annotations
are loaded from AnnotationHub based on species.}

\item{bed}{A data frame containing BED-format peak data.}

\item{species}{Species for annotation lookup. Either "Human" or "Mouse".}

\item{TxID}{Optional transcript ID to plot a specific transcript isoform.}

\item{Target_col}{Column name in bed containing the protein/target identifiers.}

\item{omit}{Character vector of target names to exclude from the plot.}

\item{order_by}{Method for ordering protein tracks: "Count" (default),
"Target", or "Region".}

\item{order_in}{Optional character vector specifying exact order of targets.}

\item{merge}{Minimum gap width (bp) for merging nearby peaks.}

\item{peaks_width}{Vertical height of each peak track row.}

\item{utr_col}{Color for UTR regions.}

\item{peak_col}{Color for peak rectangles.}

\item{exon_width}{Vertical height of exon rectangles.}

\item{utr_width}{Vertical height of UTR rectangles.}

\item{exon_col}{Color for exon/CDS regions.}

\item{RNA_Peaks_File_Path}{File path to save the output PDF plot.}

\item{Bed_File_Path}{File path to save the filtered BED data as CSV.}

\item{...}{Additional styling arguments passed to internal plotting functions.
See Styling Parameters section below.}
}
\value{
A list containing two elements: (1) A ggplot2 object of the peak
visualization, and (2) the filtered BED data frame used for plotting.
}
\description{
Creates a publication-quality visualization of RNA-binding protein peaks
overlaid on multiple gene structures within a specified genomic region.
Unlike \code{PlotGene()}, this function can display multiple genes that fall
within the specified coordinates.
}
\section{Styling Parameters}{

The following parameters can be passed via \code{...} to customize the plot appearance:

\strong{Gene Structure Colors:}
\describe{
\item{exon_fill}{Fill color for exon/CDS regions. Default: "navy"}
\item{utr_fill}{Fill color for UTR regions. Default: "lightgray"}
\item{intron_color}{Color for intron lines. Default: "gray60"}
\item{intron_linewidth}{Line width for introns. Default: 0.9}
\item{intron_arrow_len_in}{Length of intron direction arrows in inches. Default: 0.15}
}

\strong{Peak Styling:}
\describe{
\item{peak_alpha}{Opacity of peak rectangles. Default: 0.95}
\item{peak_border_color}{Border color for peaks. Default: NA (no border)}
\item{peak_border_linewidth}{Border line width for peaks. Default: 0.4}
}

\strong{Background Bands:}
\describe{
\item{band_even_fill}{Fill color for even-numbered protein track bands. Default: "#F7F8FA"}
\item{band_odd_fill}{Fill color for odd-numbered protein track bands. Default: "#FFFFFF"}
\item{band_sep_color}{Color for band separator lines. Default: "#E5E7EB"}
\item{band_sep_linewidth}{Line width for band separators. Default: 0.4}
}

\strong{Labels:}
\describe{
\item{label_size}{Font size for protein labels. Default: 5}
\item{label_color}{Color for protein labels. Default: "black"}
\item{strand_label_size}{Font size for 5'/3' strand labels. Default: 5}
\item{strand_label_color}{Color for strand labels. Default: "black"}
\item{protein_label_x_offset}{Horizontal offset for protein labels in bp. Default: 100}
}

\strong{Title and Axes:}
\describe{
\item{title_size}{Font size for plot title. Default: 25}
\item{title_color}{Color for plot title. Default: "black"}
\item{subtitle_size}{Font size for plot subtitle. Default: 12}
\item{subtitle_color}{Color for plot subtitle. Default: "black"}
\item{subtitle_sep}{Separator between gene name and coordinates in subtitle. Default: ": "}
\item{axis_title_size}{Font size for axis titles. Default: 11}
\item{axis_text_size}{Font size for axis tick labels. Default: 9}
}

\strong{Axis and Layout:}
\describe{
\item{x_lims}{Custom x-axis limits as c(min, max). Default: NULL (auto)}
\item{axis_pad_bp}{Padding in base pairs added to each side of the plot. Default: 500}
\item{axis_breaks_n}{Number of axis tick breaks. Default: 5}
\item{max_proteins}{Maximum number of protein tracks to display. Default: 40}
}

\strong{Plot Margins:}
\describe{
\item{plot_right_margin}{Right margin in points. Default: 50}
\item{plot_top_margin}{Top margin in points. Default: 30}
\item{plot_bottom_margin}{Bottom margin in points. Default: 30}
\item{plot_left_margin}{Left margin in points. Default: NULL (auto)}
}

\strong{Region Plot Specific:}
\describe{
\item{gene_label_x_offset}{Horizontal offset for gene labels as fraction of axis_pad_bp. Default: 0.25}
\item{gene_label_size}{Font size for gene name labels. Default: 5}
\item{gene_label_color}{Color for gene name labels. Default: "black"}
}

\strong{Highlighted Region:}
\describe{
\item{highlighted_region_start}{Start position of region to highlight. Default: NULL}
\item{highlighted_region_stop}{End position of region to highlight. Default: NULL}
\item{highlighted_region_color}{Color for highlighted region. Default: "pink"}
\item{highlighted_region_opacity}{Opacity for highlighted region. Default: 0.30}
}
}

\examples{
\dontrun{
  # Plot a specific genomic region
  result <- PlotRegion(
    bed = bed_data,
    gtf = gtf,
    Chr = "17",
    Start = 7565097,
    End = 7590856,
    Strand = "-"
  )
}
}
