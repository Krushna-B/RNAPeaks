% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Splicing_Map.R
\name{createSplicingMap}
\alias{createSplicingMap}
\title{Create Splicing Map}
\usage{
createSplicingMap(
  bed_file,
  SEMATS,
  moving_average = 50,
  WidthIntoExon = 50,
  WidthIntoIntron = 300,
  p_valueRetainedAndExclusion = 0.05,
  p_valueControls = 0.95,
  retained_IncLevelDifference = 0.1,
  exclusion_IncLevelDifference = -0.1,
  Min_Count = 50,
  groups = c("Retained", "Excluded", "Control"),
  control_multiplier = 2,
  control_iterations = 20,
  cores = 1,
  z_threshold = 1.96,
  min_consecutive = 10,
  show_significance = TRUE,
  return_data = FALSE,
  return_diagnostics = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{bed_file}{Either a file path to a BED file or a data frame containing
BED data with columns: chr, start, end, tag, score, strand}

\item{SEMATS}{A data frame containing SE.MATS output with columns:
chr, strand, upstreamES, upstreamEE, exonStart_0base, exonEnd,
downstreamES, downstreamEE, GeneID, PValue, FDR, IncLevelDifference,
IJC_SAMPLE_1, SJC_SAMPLE_1, IJC_SAMPLE_2, SJC_SAMPLE_2, IncLevel1, IncLevel2}

\item{moving_average}{Integer specifying the window size for moving average
smoothing. Set to NULL or 0 to disable smoothing. Default is 50.}

\item{WidthIntoExon}{Integer specifying how many bp to extend into exons.
Default is 50.}

\item{WidthIntoIntron}{Integer specifying how many bp to extend into introns.
Default is 300.}

\item{p_valueRetainedAndExclusion}{P-value threshold for retained/excluded events.
Default is 0.05.}

\item{p_valueControls}{P-value threshold for control events. Default is 0.95.}

\item{retained_IncLevelDifference}{Inclusion level difference threshold for
retained events. Default is 0.1.}

\item{exclusion_IncLevelDifference}{Inclusion level difference threshold for
excluded events. Default is -0.1.}

\item{Min_Count}{Minimum read count threshold. Default is 50.}

\item{groups}{Character vector specifying which event groups to process.
Options are "Retained", "Excluded", and/or "Control". Default is
c("Retained", "Excluded", "Control") to process all groups. Use
c("Retained", "Excluded") to skip the Control group (which can be large).}

\item{control_multiplier}{Numeric multiplier for control sample size. The
number of control events sampled per iteration is
(n_retained + n_excluded) * control_multiplier. Default is 2.0.}

\item{control_iterations}{Integer number for sampling iterations for control
sampling. The final control frequency is the mean across iterations, with
standard deviation shown as a shaded band. Default is 20.}

\item{cores}{Number of cores for parallel processing. Default is 1 (sequential).}

\item{z_threshold}{Z-score threshold for significance testing. Default is 1.96
(corresponds to p < 0.05 two-tailed).}

\item{min_consecutive}{Minimum number of consecutive significant positions
required to form a significant region. Default is 10. Helps reduce false
positives from noise.}

\item{show_significance}{Logical. If TRUE (default), displays colored bars above
the plot indicating regions where Retained/Excluded differ significantly
from Control based on z-test.}

\item{return_data}{Logical. If TRUE, returns the frequency data frame instead
of a plot. Default is FALSE.}

\item{return_diagnostics}{Logical. If TRUE, returns a list containing the
frequency data, raw bootstrap iteration results (for normality testing),
and significance results. Useful for validating bootstrap assumptions.
Default is FALSE.}

\item{verbose}{Logical. If TRUE, prints progress messages. Default is TRUE.}
}
\value{
A ggplot object showing protein binding frequency across the 4 regions
for Retained (blue), Excluded (red), and Control (black) groups.
Significant regions (z-test vs Control) are shown as colored bars above
the plot. Returns a data frame if return_data = TRUE.
}
\description{
Analyzes protein binding frequency across splicing junction regions.
Uses a 4-region structure to show where protein binding sites appear
relative to exon/intron boundaries. Filters events into Retained,
Excluded, and Control groups.
}
\details{
The function divides each splicing event into 4 regions of (WidthIntoExon +
WidthIntoIntron) bp each:
\itemize{
\item Region 1 (UE-UI5): Upstream exon end to first intron
\item Region 2 (UI3-EX3): First intron end to middle (skipped) exon start
\item Region 3 (EX5-DI5): Middle exon end to second intron
\item Region 4 (DI3-DE): Second intron end to downstream exon start
}

Events are filtered into three groups:
\itemize{
\item Retained: Significant events (PValue < threshold) with negative IncLevelDifference
\item Excluded: Significant events (PValue < threshold) with positive IncLevelDifference
\item Control: Non-significant events with stable inclusion levels
}
}
\examples{
\dontrun{
# Load BED file and SE.MATS data
bed <- read.table("peaks.bed")
semats <- read.table("SE.MATS.JC.txt", header = TRUE)

# Basic usage
createSplicingMap(bed_file = bed, SEMATS = semats)

# Use parallel processing
createSplicingMap(bed_file = bed, SEMATS = semats, cores = 4)

# Return data instead of plot
freq_data <- createSplicingMap(bed_file = bed,
                                SEMATS = semats,
                                return_data = TRUE)
}

}
